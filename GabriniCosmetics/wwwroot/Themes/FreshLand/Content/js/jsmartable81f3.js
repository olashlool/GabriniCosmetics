$.fn.jsmartable=function(n){function r(){var n=$(window).width();u.each(function(){var f=$(this),r=f.data("all-expanded"),u,e,o;if(typeof r=="undefined"&&(r=t.allExpended),u=f.find("thead tr:first th[data-breakpoint]"),e=u.length,e<=0)return!1;o=f.find("> tbody > tr").not(".jsmartable-row");o.each(function(f){var e=$(this),b=e.find("td"),v=e.data("formated"),y=e.data("expanded"),h=`<table class="jsmartable-subtable table table-bordered">
                                <tbody>`,c=0,a;for(i=0;i<u.length;i++){var o=u.eq(i),p=o.prop("cellIndex")+1,w=o.data("breakpoint"),s=e.find("td:nth-child("+p+")"),l=s.data("title");if((typeof l=="undefined"||l=="")&&(l=o.html()),s<=0)return console.log("TD Column "+p+" not found"),!1;t.breakpoint[w]!="undefined"&&t.breakpoint[w]>=n?(h+=`<tr class="jsmartable-subrow">
                            <td class="jsmartable-subcol" style="width:30%; background:#eee;">${l}</td>
                            <td class="jsmartable-subcol">${s.html()}</td>
                        </tr>`,o.hide(),s.hide(),c++):(o.show(),s.show())}h+=`
                    </tbody>
                </table>`;typeof v=="undefined"&&c>0?(e.data("formated",!0),e.after(`<tr id="jsmartable-row-${f}" class="jsmartable-row">
                        <td colspan='100%' class="jsmartable-col">
                            ${h}
                        </td>
                    </tr>`),a=t.iconMinus,(typeof y=="undefined"||y==!1)&&(typeof r=="undefined"||r==!1)&&($("#jsmartable-row-"+f).hide(),a=t.iconPlus),$("#jsmartable-row-"+f).prev().find("td:visible").first().prepend(`<a href='javascript:void(0);' class="mr-2 jsmartable-collapse" data-opened="true">${a}</a>`)):v&&c>0?$("#jsmartable-row-"+f+" > td").html(h):c<=0&&(e.removeData("formated"),$("#jsmartable-row-"+f).remove(),$(".jsmartable-collapse").remove())})})}var t=$.extend({breakpoint:{xs:556,sm:768,md:992,lg:1200,xlg:1600},iconPlus:'<i class="icon icon-plus text-info"><\/i>',iconMinus:'<i class="icon icon-flex-minus text-danger"><\/i>',allExpended:!1},n),u=this;$(window).resize(function(){r()});r();$("body").on("click",".jsmartable-collapse:not(.jsmartable-collapsed-on)",function(){$(this).addClass("jsmartable-collapsed-on");var n=$(this),i=n.closest("td").closest("tr").next();i.fadeIn();n.html(t.iconMinus)});$("body").on("click",".jsmartable-collapsed-on",function(){$(this).removeClass("jsmartable-collapsed-on");var n=$(this),i=n.closest("td").closest("tr").next();i.fadeOut("fast");n.html(t.iconPlus)});$(this).addClass("jsmatable-initialized")};$(".jsmartable").jsmartable();
